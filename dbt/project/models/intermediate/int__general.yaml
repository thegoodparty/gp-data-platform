version: 2

models:
  - name: int__general_states_zip_code_range
    description: >
        "Intermediate model that pulls selected properties from HubSpot contacts. To be used to build a general mart of Candidacies."
    columns:
      - name: state_postal_code
        description: "State postal code"
        tests:
          - not_null
          - unique
          - accepted_values:
              arguments:
                values: [
                  "AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA",
                  "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD",
                  "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ",
                  "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC",
                  "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY",
                  "DC"
                ]
      - name: zip_code_range
        description: "Zip code range"
        tests:
          - not_null
          - unique
    tests:
      - dbt_utils.expression_is_true:
          arguments:
            expression: "zip_code_range[0] < zip_code_range[1]"
      - dbt_utils.expression_is_true:
          arguments:
            expression: "size(zip_code_range) = 2"
      - dbt_utils.expression_is_true:
          arguments:
            expression: "regexp_like(zip_code_range[0], '^[0-9]{5}$')"
      - dbt_utils.expression_is_true:
          arguments:
            expression: "regexp_like(zip_code_range[1], '^[0-9]{5}$')"
