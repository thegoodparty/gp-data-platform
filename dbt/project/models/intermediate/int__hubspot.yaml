version: 2

models:
  - name: int__hubspot_candidate_codes
    description: >
        "Intermediate model that generates unique candidate codes by concatenating and cleaning
        first name, last name, state, and office type from HubSpot contacts. Used for candidate
        identification and matching."
    columns:
      - name: hubspot_candidate_code
        description: "Unique identifier generated by concatenating and cleaning candidate properties"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_match_regex:
              arguments:
                regex: ^[a-z0-9-]+__[a-z0-9-]+__[a-z0-9-]+__[a-z0-9-]+$
              config:
                severity: warn

  - name: int__hubspot_contacts
    description: >
        "Intermediate model that pulls selected properties from HubSpot contacts. To be used to build a general mart of Candidacies."
    columns:
      - name: id
        description: "HubSpot ID of the contact from the source system"
        tests:
          - unique
          - not_null
      - name: first_name
        description: "First name of the contact"
        tests:
          - not_null
      - name: last_name
        description: "Last name of the contact"
        tests:
          - not_null

  - name: int__hubspot_contacts_w_companies
    description: >
        "Intermediate model that pulls selected properties from HubSpot contacts. To be used to build a general mart of Candidacies."
    columns:
      - name: contact_id
        description: "HubSpot ID of the contact from the source system"
        tests:
          - not_null
      - name: gp_candidacy_id
        description: "GoodParty Candidacy ID of the contact"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_match_regex:
              arguments:
                regex: ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$
    tests:
    - dbt_utils.unique_combination_of_columns:
        arguments:
          combination_of_columns:
            - contact_id
            - gp_candidacy_id

  - name: int__hubspot_contest
    description: >
        "Intermediate model that pulls selected properties from HubSpot contacts. To be used to build a general mart of Contest."
    columns:
      - name: contact_id
        description: "HubSpot ID of the contact from the source system"
        tests:
          - unique
          - not_null
      - name: official_office_name
        description: "Official office name of the contact"
        tests:
          - not_null
      - name: candidate_office
        description: "Candidate office of the contact"
        tests:
          - not_null
      - name: office_type
        description: "Office type of the contact"
        tests:
          - not_null
      - name: office_level
        description: "Office level of the contact"
        tests:
          - not_null
